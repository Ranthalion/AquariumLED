<div class='content'>
    <input type='radio' name='mode' value='direct'><% if(mode == 'direct'){ %> checked='checked' <% } %>>Direct</input>
    <input type='radio' name='mode' value='schedule'><% if(mode == 'schedule'){ %> checked='checked' <% } %>>Schedule</input>
</div>
<div id='container' class='content'>
    <div id='myWidget'></div>
</div>
<script>

    $(function(){
        var model = <%- JSON.stringify(setting) %>;
        var channels = new Array();
        for(var i = 0; i < model.length; i++){
            channels.push({
                name: model[i].name,
                color: new Color(model[i].r, model[i].g, model[i].b, model[i].value)
            });
        }

        $('#myWidget').width($('body').width() - $('#swatch').width() -10);
        $('#myWidget').channelEditor({
            channels:channels,
            change: channelChange
        });

        $(':radio').click(function(){
            console.log($(this).val());
            var mode = {mode: $(this).val()};
            $.post('direct/setMode', mode);
        });
    });

    function channelChange(data){
        var vals = [];
        for(var i= 0; i < data.length; i++){
            vals[i] = data[i].color.a;
        }
        $.ajaxq('led', {
            type: 'POST',
            url: 'direct/update',
            cache: false,
            data: {'channels': vals}
        });
    }
</script>